## We crafted a yara rule based on the, beacon, strings found in the Linux, 64-bit Derusbi, and detected the following, twenty-five (25) Windows version of, Derusbi samples.,,,,
MD5,File Type,Compile Date (UTC),Mutex,XOR Key to decode driver,Rootkit MD5,C2,Port,Process created,Files created,Registry changes
3804d23ddb141c977b98c2885953444f,32-bits DLL,Mon Oct 10 02:08:34 2011 ,Ace123dx,6A F5 44 3D,32d50cf8daac1424e7249437b31d5476,firefox.dyndns-free[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msusb[3_random_characters].dat""","msusb[3_random_characters].dat
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv\Parameters=%Systemroot%\System32\msusb[3_random_characters].dat

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
d3ad90010c701e731835142fabb6bfcc,32-bits DLL,Mon Jun 27 03:18:39 2011 ,Le12xv10,C3 76 33 9F,56fa8160643d3b50dd06ef3432c31414, isacat01.gicp[.]net,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""","Msres[3_random_characters].ttf
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\System32\Msres[3_random_characters].ttf

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
75b3ccd4d3bfb56b55a46fba9463d282,32-bits DLL,Thu Nov 10 06:22:10 2011 ,Le12xv10,C3 76 33 9F,56fa8160643d3b50dd06ef3432c31414,moinia.eicp[.]net,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msresoyr.ttf""","Msresoyr.ttf
{BC87739C-6024-412c-B489-B951C2F17000}.sys
","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\Mstcpoyr.dat (appears to be an error in the registry configuration and malware doesn't persist)

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers"
70508f3b0af558833609151b368d3cc5,32-bits DLL,Sat Jan 19 12:31:39 2013 ,Le12xv10,C3 76 33 9F,56fa8160643d3b50dd06ef3432c31414,TBP,TBP,"regsvr32.exe /s /u  ""c:\windows\Mstcp[3_random_characters].dat""","Mstcp[3_random_characters].dat
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\Mstcp[3_random_characters].dat

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
72662c61ae8ef7566a945f648e9d4dd8,32-bits DLL,Mon Jun 27 03:18:39 2011 ,Le12xv10,C3 76 33 9F,56fa8160643d3b50dd06ef3432c31414,isacat01.gicp[.]net,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""","Msres[3_random_characters].ttf
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\System32\Msres[3_random_characters].ttf

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
a1fb51343f3724e8b683a93f2d42127b,32-bits DLL,Mon Jun 27 03:18:39 2011 ,Le12xv10,C3 76 33 9F,56fa8160643d3b50dd06ef3432c31414,isacat01.gicp[.]net,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""","Msres[3_random_characters].ttf
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\System32\Msres[3_random_characters].ttf

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
837b6b1601e0fa99f28657dee244223b,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8, ibm2.mail-signin[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
3c973c1ad37dae0443a078dba685c0ea,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8, ibm2.mail-signin[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
f942f98cff86f8fcde7eb0c2f465be7a,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8,bm2.network-sec[.]net,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
eeb636886ecc9ff3623d10f1efcf3c09,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8,sheisme42.jetos[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
1ae0c39cb9684652c017161f8a5aca78,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8,ibm2.mail-signin[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
128c17340cb5add26bf60dfe2af37700,32-bits DLL,Wed Mar 16 15:37:03 2011 ,Le12xv10,D6 D5 A4 A3,1e4f724933f490dda8d26d7a3fc6c10d,mykl.sytes[.]net,8080,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""",msime[3_random_characters].bpl,"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
6d620d5a903f0d714c30565a9bfdce8f,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8,kb.xxuz[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
3dec6df39910045791ee697f461baaba,32-bits DLL,Sat Mar 19 14:08:32 2011 ,Le12xv10,D6 D5 A4 A3,4d70166535702bf078e8ec436b5dd4f8,bbm2.25u[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msime[3_random_characters].bpl""","msime[3_random_characters].bpl
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc\Parameters\ServiceDll=%Systemroot%\System32\msime[3_random_characters].bpl

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
f99e10c9d269b0596bfe8ac91ec62fe9,32-bits DLL,Mon Oct 24 11:43:58 2011 ,Ace123dx,6A F5 44 3D,TBD,219.90.117[.]146,443,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msusb[3_random_characters].dat""","msusb[3_random_characters].dat
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv\Parameters\ServiceDll=%Systemroot%\System32\msusb[3_random_characters].dat

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
1e113600e397226c3e09c9c628d8ab95,32-bits EXE,Wed Oct 12 08:47:48 2011 ,Ace123dx,6A F5 44 3D (from created DLL),TBD,spx.812341[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msusb[3_random_characters].dat""","msusb[3_random_characters].dat
{BC87739C-6024-412c-B489-B951C2F17000}.sys","HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv\Parameters\ServiceDll=%Systemroot%\System32\msusb[3_random_characters].dat

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
8c0cf5bc1f75d71879b48a286f6befcf,32-bits DLL,Mon Jan 09 08:48:36 2012 ,Le12xv10,C3 76 33 9F,TBD,update.trendmicroa[.]com,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\System32\Msres[3_random_characters].ttf
3a27de4fb6e2c524e883c40a43da554e,32-bits DLL,Mon Oct 24 11:43:58 2011 ,Ace123dx,6A F5 44 3D,TBD,updata.suroot[.]com,80,"regsvr32.exe /s /u  ""C:\WINDOWS\system32\msusb[3_random_characters].dat""",msusb[3_random_characters].dat,"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv\Parameters\ServiceDll=%Systemroot%\System32\msusb[3_random_characters].dat

HKLM\System\CurrentControlSet\Sevices\{BC87739C-6024-412c-B489-B951C2F17000}\ImagePath=?\??\C:\WINDOWS\system32\Drivers\{BC87739C-6024-412c-B489-B951C2F17000}.sys?"
6802c21d3d0d80084bf93413dc0c23a7,32-bits DLL,Fri Dec 23 03:32:40 2011 ,Le12xv10,C3 76 33 9F,TBD,update.trendmicroa[.]com,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\System32\Msres[3_random_characters].ttf
449521ce87ed0111dcb0d4beff85064d,32-bits DLL,Mon Jan 09 08:48:36 2012 ,Le12xv10,C3 76 33 9F,TBD,gwks.kmwweg[.]de,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=%Systemroot%\SysWow64\Msres[3_random_characters].ttf
76767ef2d2bb25eba45203f0d2e8335b,32-bits DLL,Fri Dec 23 03:32:40 2011 ,Le12xv10,C3 76 33 9F,TBD,gw.kmwweg[.]de,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=Msres[3_random_characters].ttf
59cb505d1636119f2881caa14bf42326,32-bits DLL,Fri Dec 23 03:32:40 2011 ,Le12xv10,C3 76 33 9F,TBD,update.trendmicroa[.]com,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=Msres[3_random_characters].ttf
6ec15a34f058176be4e4685eda9a5cfc,32-bits DLL,Fri Dec 23 03:32:40 2011 ,Le12xv10,C3 76 33 9F,TBD,gwks.kmwweg[.]de,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=Msres[3_random_characters].ttf
bc32ecb75624a7bec7a901e10c195307,32-bits DLL,Fri Dec 23 03:32:40 2011 ,Le12xv10,C3 76 33 9F,TBD,gw1.kmwweg[.]de,443,"regsvr32.exe /s /u  ""c:\windows\system32\Msres[3_random_characters].ttf""",Msres[3_random_characters].ttf,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\helpsvc\Parameters\ServiceDll=Msres[3_random_characters].ttf
3a76b081fc7964ab239f26d356c59692,64-bits DLL,Tue Mar 27 08:22:17 2012 ,TBD,Not obfuscated,TBD,TBP,TBP,TBP,TBP,TBP